<template>
  <div class="header-wrap">
    <header>
      <div class="title">
        <router-link to="/">
          <img :src="config.logo">
          <span v-text="config.title"></span>
        </router-link>
      </div>
      <!-- TODO: mobile support -->
      <img class="menu-icon" src="../assets/img/menu.svg" @click="toggleSideMenu">
      <nav>
        <ul>
          <li v-for="item in navigation" :class="{'nav-dropdown-container': item.type === 'dropdown'}">
            <span v-if="item.type === 'dropdown'" v-text="item.label"></span>
            <ul v-if="item.type === 'dropdown'" class="nav-dropdown">
              <li v-for="child in item.children">
                <a v-if="child.type === 'outgoing'" :href="child.link" v-text="child.label" target="_blank" rel="noopener noreferrer"></a>
                <router-link v-if="child.type !== 'outgoing'" :to="child.path" v-text="child.label"></router-link>
              </li>
            </ul>
            <a v-if="item.type === 'outgoing'" :href="item.link" target="_blank" rel="noopener noreferrer" v-text="item.label"></a>
            <router-link v-if="item.type !== 'dropdown' && item.type !== 'outgoing'" :to="item.path" v-text="item.label"></router-link>
          </li>
        </ul>
      </nav>
    </header>
  </div>
</template>

<script>
  export default {
    name: 'vuelog-header',

    computed: {
      config () {
        return this.$store.getters.config
      },

      navigation () {
        return this.$store.getters.navigation
      }
    },

    methods: {
      toggleSideMenu () {
        // TODO
      }
    }
  }
</script>

<style lang="stylus" scoped>
  .header-wrap
    background rgba(255, 255, 255, .8)
    box-shadow 0 0 4px rgba(0, 0, 0, .25)
    width 100%
    position fixed
    left 0
    right 0
    top 0
    z-index 8000

  header
    display flex
    width 900px
    margin 0 auto
    padding 25px 0

  a:hover
    text-decoration none

  .title
    flex 1
    font-family 'Dosis', 'Source Sans Pro', 'PingFang SC', 'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif
    font-size 24px

    a
      color #34495e
      display inline-block
      font-weight 500

    img
    span
      display inline-block
      height 32px
      margin-right 5px
      vertical-align middle

  .menu-icon
    cursor pointer
    display none
    height 48px
    width 48px
    position absolute
    left 12px
    top 8px
    z-index 9000

  ul
    margin 0
    padding 0

  li
    display inline-block
    font-size 15px
    line-height 40px
    margin-left 20px

    &:first-child
      margin-left 0

    a
      color #7f8c8d
      font-size 15px
      font-weight 400

      &:hover
      &.router-link-active
        color #34495e
        border-bottom 3px solid #42b983

  .nav-dropdown
    position absolute
    top 100%
    left -9000px
    background #fff
    padding 10px 0
    border 1px solid #ddd
    border-bottom-color #ccc
    border-radius 4px

    li
      display block
      line-height 28px
      margin 0

    a
      display block
      font-size .9em
      padding 0 1.4em
    
      &:hover
        color #42b983
        border-bottom none

  .nav-dropdown-container
    position relative

    > span
      color #7f8c8d
      font-weight 400

      &:after
        content ''
        display inline-block
        vertical-align middle
        margin-top -1px
        margin-left 6px
        width 0
        height 0
        border-left 4px solid transparent
        border-right 4px solid transparent
        border-top 5px solid #ccc
        transition transform .3s ease-in-out

      &:hover
        color #34495e

    &:hover
      .nav-dropdown
        left -15px

      > span:after
        transform rotateZ(180deg)

  @media screen and (max-width: 1059px)
    .nav-dropdown-container:hover .nav-dropdown
      left auto
      right -30px

  @media screen and (max-width: 999px)
    header
      opacity 1 // 0

    .menu-icon
      display block

</style>
